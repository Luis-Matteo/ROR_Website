<!doctype html>
<meta name=viewport content="width=device-width, initial-scale=1.0">

<title>{% if page.title != 'Sparanoid' %}{{ site.name }} - {% endif %}{{ page.title }}</title>
<link rel=alternate href=/{{ site.feed }} type=application/atom+xml>
<link rel=stylesheet href=/{{ site.css }}/a.css>
{% if page.title == 'Sparanoid' %}<link rel=dns-prefetch href={{ site.file }}>{% endif %}

<!-- Twitter Cards support for category "work", more info https://dev.twitter.com/docs/cards -->
{% if page.category == 'work' %}
  <meta name=twitter:card content="summary">
  <meta name=twitter:site content="@{{ site.twitter }}">
  <meta name=twitter:creator content="@tunghsiao">
  <meta name=twitter:url content="{{ site.url }}{{ page.url }}">
  <meta name=twitter:title content="{{ page.title | xml_escape }}">
  <meta name=twitter:description content="{{ page.excerpt | xml_escape }}">
  <meta name=twitter:image content="{{ site.file }}/thumb/{% if page.thumb %}{{ page.thumb }}{% else %}na.png{% endif %}">
{% endif %}

<!-- Twitter Cards support for cateogry "note" -->
{% if page.category == 'note' %}
  <meta name=twitter:card content="summary">
  <meta name=twitter:site content="@{{ site.twitter }}">
  <meta name=twitter:creator content="@tunghsiao">
  <meta name=twitter:url content="{{ site.url }}{{ page.url }}">
  <meta name=twitter:title content="{{ page.title | xml_escape }}">
  <meta name=twitter:description content="{{ page.content | xml_escape }}">
{% endif %}

<!-- Error page specified styles -->
{% if page.title == 'Error' %}
  <style>
    :root { -webkit-filter: invert(100%); }
  </style>
{% endif %}

<!-- If one post has excerpt defined, display it for better SEO result -->
{% if page.excerpt %}
  <meta name=description content="{{ page.excerpt }}">
{% endif %}

<!-- Header, logo, we need a .index class here to include homepage specified styles -->
{% if page.title == 'Sparanoid' or page.title == 'Error' %}
  <header class=index>
    <h3>latest Work</h3>
    {% for post in site.categories.work limit:1 %}
      <h2><a href="{{ post.url }}/">{{ post.title }}</a></h2>
    {% endfor %}
{% else %}
  <header>
{% endif %}
  <!-- There's a normal header for the other pages -->
  <h1><a href=/ role=logo accesskey=x>Sparanoid</a></h1>
</header>

<!-- Wrap in all width sensitive elements -->
<div class="wrapper">

  <!-- Main navigation with current page / categoriy highlighted -->
  <nav role=navigation>
    {% if page.permalink == '/' or page.category == 'home' %}<ul class=nav-home>{% endif %}
    {% if page.permalink == '/work/' or page.category == 'work' %}<ul class=nav-work>{% endif %}
    {% if page.permalink == '/store/' or page.category == 'store' %}<ul class=nav-store>{% endif %}
    {% if page.permalink == '/note/' or page.category == 'note' %}<ul class=nav-note>{% endif %}
    {% if page.permalink == '/about/' or page.category == 'about' %}<ul class=nav-about>{% endif %}
      <li{% if page.permalink == '/work/' or page.category == 'work' %} role=current{% endif %}><a href=/work/>Work</a></li>
      <li{% if page.permalink == '/store/' or page.category == 'store' %} role=current{% endif %}><a href=/store/>Store</a></li>
      <li{% if page.permalink == '/' or page.category == 'home' %} role=current{% endif %} accesskey=x><a href=/>Home</a></li>
      <li{% if page.permalink == '/note/' or page.category == 'note' %} role=current{% endif %}><a href=/note/>Note</a></li>
      <li{% if page.permalink == '/about/' or page.category == 'about' %} role=current{% endif %}><a href=/about/>About</a></li>
    </ul>
  </nav>

  <!-- All dynamic, user generated content go here. It's linked with page.html and post.html at the moment -->
  {{ content }}

  <!-- Display a paginator if current post category is "note" -->
  {% if page.category == 'note' %}
    <nav role=pagination>
      {% if page.next_in_categories.url %}
        <a role=next href={{ page.next_in_categories.url }}/>
          <span>Next</span>
          <span role=tooltip>{{ page.next_in_categories.title }}</span>
        </a>
      {% else %}
      {% endif %}
      {% if page.previous_in_categories.url %}
        <a role=prev href={{ page.previous_in_categories.url }}/>
          <span>Prev</span>
          <span role=tooltip>{{ page.previous_in_categories.title }}</span>
        </a>
      {% else %}
      {% endif %}
    </nav>
  {% endif %}

  <!-- Display post thumbnails for tag "design" if current post category is "work" -->
  {% if page.tag == 'design' %}
    <aside>
      <h3 role=work-list-title>Other Design Works</h3>
      <ul role=work-list>
        {% for post in site.tags.design %}
          {% include work-thumb.html %}
        {% endfor %}
      </ul>
    </aside>
  {% endif %}

  <!-- Display post thumbnails for tag "drawing" if current post category is "work" -->
  {% if page.tag == 'drawing' %}
    <aside>
      <h3 role=work-list-title>Other Sketches / Paintings</h3>
      <ul role=work-list>
        {% for post in site.tags.drawing %}
          {% include work-thumb.html %}
        {% endfor %}
      </ul>
    </aside>
  {% endif %}

</div><!-- .wrapper -->

<!-- Footer and sponsor ad section -->
{% if page.title != 'Sparanoid' %}
  <!-- Insert ad here -->

  <footer>
    <p><a href=/>{{ site.name }}</a> / <a href=/{{ site.feed }} title="Feed - Atom (The Atom Syndication Format)">Atom</a></p>
  </footer>
{% endif %}

<!-- Add lazyload script for "Work" page and its posts -->
{% if page.permalink == '/work/' or page.category == 'work' %}
  {% include lazyload.html %}
{% endif %}

<!-- Add FlexSlider script for posts with sliders -->
{% if page.plugin == 'slider' %}
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script src="/{{ site.css }}/jquery.flexslider-min.js"></script>
  <script>
  $(window).load(function() {
    $('.flexslider').flexslider({
      smoothHeight: true,
      slideshowSpeed: 4000,
      animationSpeed: 400,
      controlNav: false,
      directionNav: false,
      start: function(slider) {
        $('.slides li').click(function(event){
          event.preventDefault();
          slider.flexAnimate(slider.getTarget("next"));
        });
      }
    });
  });
  </script>
{% endif %}